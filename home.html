<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Flying 64th – Home</title>
  <meta name="description" content="The Flying 64th Flying Club – affordable general aviation in East Tennessee based at Oliver Springs Airport (Braden Field). Operates Cessna 172 & 150." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0b1117; --ink:#e6edf3; --muted:#9fb1c3; --panel:#0f1722; --rule:#1f2a38; --accent:#58a6ff;
      --card:#0f1722cc; /* translucent for glass effect */
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.6}

    /* ===== NAV ===== */
    .site-header{
      position:sticky; top:0; z-index:50;
      backdrop-filter:saturate(160%) blur(8px);
      background:rgba(11,17,23,.75);
      border-bottom:1px solid var(--rule);
    }
    .nav{
      max-width:1200px; margin:0 auto; padding:12px 18px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px;
      color:var(--ink); text-decoration:none; font-size:22px; white-space:nowrap;
    }
    .brand img{ height:34px; width:auto }
    header nav{
      display:flex; align-items:center; gap:18px; flex-wrap:nowrap;
    }
    header nav a{
      color:var(--muted); text-decoration:none; padding:8px 12px; border-radius:10px;
      transition:all .18s ease;
    }
    header nav a:hover{ color:var(--ink); background:rgba(255,255,255,.06) }
    header nav a.active{ color:#001a33; background:var(--accent); font-weight:700 }
    @media (max-width:900px){
      .nav{ padding:10px 14px; flex-wrap:wrap }
      header nav{ width:100%; gap:10px; overflow-x:auto; -webkit-overflow-scrolling:touch; scrollbar-width:none }
      header nav::-webkit-scrollbar{ display:none }
      header nav a{ padding:8px 10px; font-size:15px }
    }

    /* ===== HERO ===== */
    .hero{
      position:relative;min-height:56vh;display:grid;place-items:end;
      isolation:isolate;
      background:#000 url("images/bothplanes_homepage.jpg") center/cover no-repeat;
    }
    .hero::after{
      content:"";position:absolute;inset:0;z-index:0;
      background:linear-gradient(180deg, rgba(11,17,23,.15) 0%, rgba(11,17,23,.65) 55%, rgba(11,17,23,1) 100%);
    }
    .hero-inner{
      position:relative;z-index:1;max-width:1100px;margin:0 auto;padding:48px 18px 24px;
      width:100%;
    }
    .hero h1{margin:0 0 8px;font-size:clamp(28px,4vw,44px);font-weight:800}
    .hero p{margin:0;color:#d0d9e3;max-width:900px}
    .cta-row{margin-top:18px;display:flex;flex-wrap:wrap;gap:10px}
    .btn{display:inline-block;padding:10px 14px;border-radius:12px;border:1px solid var(--rule);text-decoration:none;color:var(--ink);cursor:pointer}
    .btn.primary{background:var(--accent);border-color:transparent;color:#001a33;font-weight:700}
    .btn:hover{transform:translateY(-1px)}

    /* ===== CONTENT CARDS ===== */
    .container{max-width:1100px;margin:0 auto;padding:28px 18px}
    .grid{display:grid;gap:16px}
    .grid.two{grid-template-columns:1.4fr 1fr}
    @media (max-width:960px){ .grid.two{grid-template-columns:1fr} }

    .card{
      background:var(--card);
      border:1px solid var(--rule);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px 18px;
    }
    .card h2{margin:0 0 8px;font-size:1.25rem}
    .muted{color:var(--muted)}
    .list{padding-left:18px;margin:8px 0}
    .list li{margin:6px 0}

    /* ===== FOOTER ===== */
    .site-footer{border-top:1px solid var(--rule);margin-top:28px}
    .foot{max-width:1100px;margin:0 auto;padding:18px;color:var(--muted);text-align:center}

    /* ===== AUTH MODAL ===== */
    .auth-modal{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;place-items:center;z-index:1000}
    .auth-modal.open{display:grid}
    .auth-card{width:min(420px,92vw);background:#0f1722;color:#e6edf3;border:1px solid #1f2a38;border-radius:14px;padding:18px 18px 12px;position:relative}
    .auth-title{margin:0 0 10px 0;font-size:20px;font-weight:800}
    .auth-x{position:absolute;right:14px;top:12px;border:0;background:transparent;color:#9fb1c3;font-size:18px;cursor:pointer}
    .auth-label{display:block;margin-top:10px;margin-bottom:4px;color:#9fb1c3;font-size:13px}
    .auth-input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #1f2a38;background:#0b1117;color:#e6edf3}
    .auth-row{display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:12px}
    .auth-btn{flex:1;padding:10px 12px;border-radius:10px;border:1px solid #1f2a38;background:#141b26;color:#e6edf3;cursor:pointer}
    .auth-btn.primary{background:#58a6ff;color:#001a33;border-color:transparent;font-weight:700}
    .auth-link{background:none;border:0;color:#9fb1c3;cursor:pointer}
    .auth-msg{min-height:18px;color:#9fb1c3;margin:8px 0 4px}
    .invite-wrap{margin-top:6px}
  </style>
</head>
<body>

<!-- ===== NAV ===== -->
<header class="site-header">
  <div class="nav">
    <a class="brand" href="home.html">
      <img src="images/flying64thlogo.png" alt="The Flying 64th Logo" style="width:80px; height:auto;">
      <span>The Flying 64th</span>
    </a>
    <nav>
      <a class="active" href="home.html">Home</a>
      <a href="calendar.html">Calendar</a>
      <a href="becomeamember.html">Become a Member</a>
      <a href="photos.html">Photos</a>
      <a href="poh&manuals.html">POH &amp; Manuals</a>
      <a id="signinBtn" class="btn" style="margin-left:8px;">Sign In</a>
    </nav>
  </div>
</header>

<!-- ===== HERO ===== -->
<section class="hero">
  <div class="hero-inner">
    <h1>Affordable General Aviation in East Tennessee</h1>
    <p>The Flying 64th is a member-owned flying club based at Oliver Springs Airport (Braden Field). We operate a Cessna 172K and a Cessna 150L, both ADS-B equipped and maintained to FAA standards.</p>
  </div>
</section>

<!-- ===== CONTENT ===== -->
<main class="container">
  <div class="grid two">
    <article class="card">
      <h2>About the Club</h2>
      <p class="muted">The Flying 64th is a general aviation flying club offering the most affordable flying in East Tennessee. Convenient to Oak Ridge, West Knoxville, Lenoir City, Harriman, and Oliver Springs, members buy into the club rather than simply renting from a pool. Every member is an owner in each aircraft.</p>
      <p class="muted">The club has a <strong>Cessna 172K</strong> and a <strong>Cessna 150L</strong>. Both planes are equipped with ADSB-IN/OUT. The 172 is equipped with Garmin 355 GPS Navigation.</p>
      <p class="muted">The Flying 64th has been operating out of Oliver Springs Airport as a club for pilots of all ages and skill levels since its formation in 1954 by the merger of two smaller clubs which trace their roots to 1946. The name originated from the association of charter members with the 9964th local Air Force Reserve Squadron.</p>
    </article>

    <aside class="card">
      <h2>Why Join?</h2>
      <ul class="list">
        <li>Shared ownership keeps costs low</li>
        <li>Two well-equipped aircraft (2-seat & 4-seat)</li>
        <li>Supportive pilot community & mentorship</li>
        <li>Great for training and time-building</li>
      </ul>
    </aside>
  </div>
</main>

<!-- ===== FOOTER ===== -->
<footer class="site-footer">
  <div class="foot">
    © <span id="y"></span> The Flying 64th • Oliver Springs, Tennessee
  </div>
</footer>

<!-- ===== AUTH MODAL (login / create account with invite) ===== -->
<div id="authModal" class="auth-modal" aria-hidden="true">
  <div class="auth-card" role="dialog" aria-modal="true" aria-labelledby="authTitle">
    <button id="closeModal" class="auth-x" aria-label="Close">✕</button>
    <h3 id="authTitle" class="auth-title">Member Sign In</h3>

    <label class="auth-label" for="email">Email</label>
    <input id="email" class="auth-input" type="email" placeholder="you@example.com" autocomplete="email">

    <label class="auth-label" for="password">Password</label>
    <input id="password" class="auth-input" type="password" placeholder="••••••••" autocomplete="current-password">

    <div class="invite-wrap">
      <label class="auth-label" for="invite">Invite Code (new accounts)</label>
      <input id="invite" class="auth-input" type="text" placeholder="F64-CHRIS-2025-9QK7ATJ3">
    </div>

    <div class="auth-row">
      <button id="doSignIn" class="auth-btn primary">Sign In</button>
      <button id="doSignUp" class="auth-btn">Create Account</button>
    </div>

    <div class="auth-row">
      <button id="doReset" class="auth-link" type="button">Forgot password?</button>
      <button id="signOutBtn" class="auth-link" type="button">Sign out</button>
    </div>

    <p id="authMsg" class="auth-msg"></p>
  </div>
</div>

<script>
  document.getElementById("y").textContent = new Date().getFullYear();
</script>

<!-- ===== Firebase + Auth Logic ===== -->
<script type="module">
  // Firebase SDKs
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
  import {
    getAuth, onAuthStateChanged,
    signInWithEmailAndPassword, createUserWithEmailAndPassword,
    sendPasswordResetEmail, sendEmailVerification, signOut
  } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";
  import {
    getFirestore, doc, getDoc, updateDoc, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";

  // Your Firebase config (from Firebase console)
  const firebaseConfig = {
    apiKey: "AIzaSyAI5lbnXxAiBQThX6Y4tEuqqQ1cY6bn74",
    authDomain: "flying64th-b7813.firebaseapp.com",
    projectId: "flying64th-b7813",
    storageBucket: "flying64th-b7813.appspot.com",
    messagingSenderId: "244940935157",
    appId: "1:244940935157:web:58e7305541377ba743dabc"
  };

  // Init
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db   = getFirestore(app);

  // UI refs
  const openBtn   = document.getElementById('signinBtn');
  const modal     = document.getElementById('authModal');
  const closeBtn  = document.getElementById('closeModal');
  const emailEl   = document.getElementById('email');
  const passEl    = document.getElementById('password');
  const inviteEl  = document.getElementById('invite');
  const doSignIn  = document.getElementById('doSignIn');
  const doSignUp  = document.getElementById('doSignUp');
  const doReset   = document.getElementById('doReset');
  const signOutBtn= document.getElementById('signOutBtn');
  const msgEl     = document.getElementById('authMsg');

  // Modal open/close
  function openModal(){ modal.classList.add('open'); modal.setAttribute('aria-hidden','false'); msgEl.textContent=""; }
  function closeModal(){ modal.classList.remove('open'); modal.setAttribute('aria-hidden','true'); }
  openBtn?.addEventListener('click', openModal);
  closeBtn?.addEventListener('click', closeModal);
  modal?.addEventListener('click', e => { if (e.target === modal) closeModal(); });

  // Helper to show messages
  const say = (t, isErr=false)=>{ msgEl.textContent = t; msgEl.style.color = isErr ? '#ffb4b4' : '#9fb1c3'; };

  // Auth state → update button label
  onAuthStateChanged(auth, (user)=>{
    if (user?.emailVerified){
      if (openBtn) openBtn.textContent = "Account";
      say("Signed in as " + (user.email || "member"));
    } else if (user) {
      if (openBtn) openBtn.textContent = "Account";
      say("Please verify your email to access member features.");
    } else {
      if (openBtn) openBtn.textContent = "Sign In";
      say("");
    }
  });

  // Sign in
  doSignIn.addEventListener('click', async ()=>{
    const email = emailEl.value.trim();
    const pass  = passEl.value;
    if (!email || !pass) return say("Enter email and password.", true);
    try {
      await signInWithEmailAndPassword(auth, email, pass);
      say("Signed in."); closeModal();
    } catch(err){ say(err.message, true); }
  });

  // Create account (requires a valid, unused invite code)
  doSignUp.addEventListener('click', async ()=>{
    const email = emailEl.value.trim();
    const pass  = passEl.value;
    const code  = (inviteEl.value || "").trim();
    if (!email || !pass || !code) return say("Email, password, and invite code are required.", true);

    try {
      // 1) Check invite exists & unused
      const inviteRef  = doc(db, "invites", code);
      const inviteSnap = await getDoc(inviteRef);
      if (!inviteSnap.exists()) return say("Invalid invite code.", true);
      if (inviteSnap.data().used === true) return say("This invite code has already been used.", true);

      // 2) Create user
      const cred = await createUserWithEmailAndPassword(auth, email, pass);

      // 3) Send verify email
      await sendEmailVerification(cred.user);

      // 4) Mark invite as used
      await updateDoc(inviteRef, {
        used: true,
        usedBy: cred.user.uid,
        usedAt: serverTimestamp()
      });

      say("Account created! Check your inbox to verify your email.");
    } catch(err){ say(err.message, true); }
  });

  // Reset password
  doReset.addEventListener('click', async ()=>{
    const email = emailEl.value.trim();
    if (!email) return say("Enter your email first.", true);
    try {
      await sendPasswordResetEmail(auth, email);
      say("Password reset email sent.");
    } catch(err){ say(err.message, true); }
  });

  // Sign out
  signOutBtn.addEventListener('click', async ()=>{
    await signOut(auth);
    say("Signed out.");
  });
</script>
</body>
</html>
